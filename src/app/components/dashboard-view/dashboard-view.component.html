<div class="animate-fadeIn grid grid-cols-1 lg:grid-cols-12 gap-6">

    <!-- SENSORS (4 cols) -->
    <div class="lg:col-span-4 space-y-6">
        <h2 class="text-xs font-bold text-gray-500 uppercase tracking-widest flex items-center gap-2">IoT Sensors</h2>

        <!-- Interactive Temp Card -->
        <div
            class="relative bg-[#101D35]/80 backdrop-blur rounded-xl border border-blue-900/30 p-6 shadow-xl overflow-hidden group hover:border-[#00D1FF]/30 transition-all">
            <div class="flex justify-between items-start mb-4">
                <span class="text-gray-400 text-sm font-medium">Internal Temp</span>
                <span [class]="getTempColorClass()" class="px-2 py-1 rounded text-xs font-bold uppercase border">
                    {{ getStatusText() }}
                </span>
            </div>
            <div class="flex items-baseline gap-1">
                <span class="text-5xl font-mono font-bold text-white tracking-tighter">{{ temperature.toFixed(1)
                    }}</span>
                <span class="text-xl text-gray-500">°C</span>
            </div>
            <div class="mt-4 w-full bg-[#000B1D] rounded-full h-1.5 overflow-hidden">
                <div class="h-full transition-all duration-500 ease-out shadow-[0_0_10px_currentColor]"
                    [ngClass]="getTempBarClass()" [style.width.%]="(temperature / 20) * 100">
                </div>
            </div>
            <p class="mt-2 text-xs text-gray-500">Threshold: <span class="text-gray-300 font-mono">{{
                    config.tempThreshold.toFixed(1) }}°C</span></p>
        </div>

        <!-- Humidity -->
        <div class="bg-[#101D35]/80 backdrop-blur rounded-xl border border-blue-900/30 p-6 shadow-xl">
            <div class="flex justify-between items-start mb-4">
                <span class="text-gray-400 text-sm font-medium">Humidity</span>
                <span
                    class="text-green-400 text-xs font-bold bg-green-400/10 px-2 py-1 rounded border border-green-400/20 shadow-[0_0_5px_rgba(74,222,128,0.2)]">OK</span>
            </div>
            <div class="flex items-baseline gap-1">
                <span class="text-4xl font-mono font-bold text-white tracking-tighter">{{ humidity.toFixed(1) }}</span>
                <span class="text-lg text-gray-500">%</span>
            </div>
        </div>

        <!-- Map Placeholder -->
        <div
            class="bg-[#101D35]/80 backdrop-blur rounded-xl border border-blue-900/30 p-4 h-32 flex items-center justify-center relative overflow-hidden">
            <div class="absolute inset-0 bg-[url('https://upload.wikimedia.org/wikipedia/commons/e/ec/World_map_blank_without_borders.svg')] bg-cover opacity-10 bg-center"
                style="filter: invert(1) sepia(1) hue-rotate(180deg) saturate(2);"></div>
            <div class="relative z-10 flex flex-col items-center">
                <div class="w-3 h-3 bg-[#00D1FF] rounded-full animate-ping absolute"></div>
                <div class="w-3 h-3 bg-[#00D1FF] rounded-full relative border-2 border-white"></div>
                <span class="text-xs text-white font-mono mt-2 bg-black/50 px-2 rounded border border-blue-500/20">En
                    Route: IN -> DE</span>
            </div>
        </div>
    </div>

    <!-- TERMINAL MINI (5 cols) -->
    <div class="lg:col-span-5 flex flex-col gap-2">
        <h2 class="text-xs font-bold text-gray-500 uppercase tracking-widest">Live Agent Decision Log</h2>
        <div
            class="flex-1 bg-[#000510] rounded-xl border border-gray-800 overflow-hidden flex flex-col shadow-2xl relative min-h-[400px]">
            <div class="bg-[#0B1926] px-3 py-1.5 border-b border-gray-800 flex justify-between">
                <span class="text-[10px] text-gray-400 font-mono">agent_core_v1.py</span>
                <div class="flex gap-1">
                    <div class="w-2 h-2 rounded-full bg-red-500/50"></div>
                    <div class="w-2 h-2 rounded-full bg-yellow-500/50"></div>
                    <div class="w-2 h-2 rounded-full bg-green-500/50"></div>
                </div>
            </div>
            <div class="flex-1 p-3 font-mono text-xs overflow-y-auto space-y-1.5 scroll-smooth" #scrollContainer>
                <div *ngFor="let log of logs" class="flex gap-2">
                    <span class="text-gray-600 shrink-0">{{ log.timestamp | date:'HH:mm:ss' }}</span>
                    <span [ngClass]="{
                    'text-green-400': log.type === 'success',
                    'text-red-400 font-bold': log.type === 'error',
                    'text-yellow-300': log.type === 'warning',
                    'text-[#00D1FF]': log.source === 'AI_AGENT',
                    'text-gray-400': log.type === 'neutral'
                  }">
                        <span *ngIf="log.source === 'AI_AGENT'"
                            class="text-[10px] bg-blue-500/10 text-[#00D1FF] px-1 rounded mr-1">AI</span>
                        {{ log.message }}</span>
                </div>
                <div *ngIf="isProcessing" class="text-[#00D1FF] animate-pulse pl-4">Agent is thinking...</div>
            </div>
        </div>
    </div>

    <!-- ACTIVITY FEED (3 cols) -->
    <div class="lg:col-span-3 flex flex-col gap-2">
        <h2 class="text-xs font-bold text-gray-500 uppercase tracking-widest">Recent Actions</h2>
        <div class="flex-1 bg-[#101D35]/80 backdrop-blur rounded-xl border border-blue-900/30 p-0 overflow-hidden">
            <div *ngIf="transactions.length === 0"
                class="h-full flex flex-col items-center justify-center text-gray-500 p-4 text-center">
                <svg class="w-8 h-8 mb-2 opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                </svg>
                <span class="text-xs">No settlements yet</span>
            </div>
            <div class="divide-y divide-blue-900/30">
                <div *ngFor="let tx of transactions" class="p-3 hover:bg-blue-500/5 transition-colors group">
                    <div class="flex justify-between items-start">
                        <div class="text-xs text-white font-medium">{{ tx.purpose }}</div>
                        <div class="text-xs font-mono font-bold text-red-400">-{{ tx.amount }} ₳</div>
                    </div>
                    <div class="flex justify-between items-end mt-1">
                        <div class="text-[10px] text-gray-500 font-mono">{{ tx.hash | slice:0:6 }}...</div>
                        <div
                            class="text-[10px] bg-green-900/30 text-green-400 px-1.5 rounded border border-green-500/20 shadow-[0_0_5px_rgba(74,222,128,0.1)]">
                            {{ tx.status }}</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

</div>